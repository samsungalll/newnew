(this["webpackJsonpoffice-user-auto-create"]=this["webpackJsonpoffice-user-auto-create"]||[]).push([[0],{158:function(e,t,n){},284:function(e,t,n){"use strict";n.r(t);var c=n(5),s=n(0),i=n(27),r=n.n(i),a=n(293),l=(n(157),n(158),n(286)),o=n(287),j=n(294),b=n(56),f=n(295);function u(){var e={fontWeight:500,fontSize:24};return Object(c.jsx)(l.a,{style:{height:"100%"},children:Object(c.jsx)(o.a,{lg:{span:14,offset:5},xs:{span:22,offset:1},children:Object(c.jsxs)("div",{className:"display-flex align-center justify-between",children:[Object(c.jsxs)(j.b,{align:"center",children:[Object(c.jsx)("img",{style:{height:28},src:"https://i.loli.net/2020/04/21/ST9ru5mwVqUXnKO.png",alt:""}),Object(c.jsx)("div",{style:e,children:"|"}),Object(c.jsx)("div",{style:e,children:"Office"})]}),Object(c.jsx)(b.a,{shape:"circle",type:"primary",icon:Object(c.jsx)(f.a,{}),onClick:function(){return window.open("https://github.com/zayabighead/Office-User-Auto-Create")}})]})})})}var d=n(49),h=n(291),O=n(149),x=n(289),p=n(292),m=n(290),g=n(288),y=n(296),w=n(297),C=n(298),k=n(109),v=n.n(k);function S(){var e=Object(s.useState)(!1),t=Object(d.a)(e,2),n=t[0],i=t[1],r=Object(s.useState)({subscriptions:[{name:"",sku:""}],domains:[],getCodeLink:""}),a=Object(d.a)(r,2),j=a[0],f=a[1],u=Object(s.useState)({email:"",password:""}),h=Object(d.a)(u,2),k=h[0],S=h[1];Object(s.useEffect)((function(){i(!0),fetch("".concat("/","getOfficeConfig")).then((function(e){e.json().then((function(e){f(e)})),i(!1)})).catch((function(e){O.b.error(JSON.stringify(e))}))}),[]);var I=Object(c.jsxs)(x.a,{labelCol:{span:4},wrapperCol:{span:20},children:[Object(c.jsx)(x.a.Item,{label:"\u90ae\u7bb1",children:Object(c.jsx)(p.a,{value:k.email,prefix:Object(c.jsx)(y.a,{}),suffix:Object(c.jsx)(w.a,{onClick:function(){v()(k.email),O.b.success("\u5df2\u590d\u5236\u90ae\u7bb1")}})})}),Object(c.jsx)(x.a.Item,{label:"\u5bc6\u7801",children:Object(c.jsx)(p.a,{value:k.password,prefix:Object(c.jsx)(C.a,{}),suffix:Object(c.jsx)(w.a,{onClick:function(){v()(k.password),O.b.success("\u5df2\u590d\u5236\u5bc6\u7801")}})})}),Object(c.jsx)(x.a.Item,{style:{float:"right"},children:Object(c.jsx)(b.a,{onClick:function(){return window.open("https://office.com/login")},type:"primary",htmlType:"submit",children:"\u767b\u5f55"})})]}),z=Object(c.jsxs)(x.a,{name:"basic",onFinish:function(e){i(!0),fetch("".concat("/","getOffice"),{method:"POST",body:JSON.stringify(e)}).then((function(e){e.json().then((function(e){e.success?(O.b.success(e.msg),S(e.account)):O.b.error(e.msg.toString())})),i(!1)})).catch((function(e){O.b.error(JSON.stringify(e))}))},labelCol:{span:4},wrapperCol:{span:20},children:[Object(c.jsx)(x.a.Item,{label:"\u8ba2\u9605",name:"subscription",rules:[{required:!0,message:"\u5fc5\u9009"}],children:Object(c.jsx)(m.a,{placeholder:"\u9009\u5219\u8ba2\u9605",children:j.subscriptions.map((function(e){return Object(c.jsx)(m.a.Option,{value:e.sku,children:e.name},e.sku)}))})}),Object(c.jsx)(x.a.Item,{label:"\u90ae\u7bb1",name:"email",rules:[{required:!0,message:"\u5fc5\u586b"}],children:Object(c.jsxs)(p.a.Group,{compact:!0,children:[Object(c.jsx)(x.a.Item,{name:["email","username"],noStyle:!0,rules:[{required:!0,message:"\u5fc5\u586b"}],children:Object(c.jsx)(p.a,{style:{width:"55%"},placeholder:"\u7528\u6237\u540d"})}),Object(c.jsx)(x.a.Item,{name:["email","domain"],noStyle:!0,rules:[{required:!0,message:"\u5fc5\u9009"}],children:Object(c.jsx)(m.a,{style:{width:"45%"},placeholder:"\u9009\u62e9\u540e\u7f00",children:j.domains.map((function(e){return Object(c.jsxs)(m.a.Option,{value:e,children:["@",e]},e)}))})})]})}),Object(c.jsx)(x.a.Item,{label:"\u6fc0\u6d3b\u7801",name:"code",rules:[{required:!0,message:"\u5fc5\u586b"}],children:Object(c.jsx)(p.a,{placeholder:"\u6fc0\u6d3b\u7801",addonAfter:Object(c.jsx)("a",{href:j.getCodeLink,target:"_blank",rel:"noreferrer",children:"\u83b7\u53d6\u6fc0\u6d3b\u7801"})})}),Object(c.jsx)(x.a.Item,{style:{float:"right"},children:Object(c.jsx)(b.a,{type:"primary",htmlType:"submit",children:"\u63d0\u4ea4"})})]});return Object(c.jsx)(g.a,{spinning:n,children:Object(c.jsx)(l.a,{children:Object(c.jsx)(o.a,{lg:{span:14,offset:5},xs:{span:24},children:k.password?I:z})})})}function I(){var e=Object(s.useState)(!1),t=Object(d.a)(e,2),n=t[0],i=t[1],r=Object(s.useState)(""),a=Object(d.a)(r,2),l=a[0],o=a[1];return Object(s.useEffect)((function(){fetch("".concat("/","getNotice")).then((function(e){e.text().then((function(e){e&&(o(e),i(!0))}))}))}),[]),Object(c.jsx)(h.a,{title:"\u516c\u544a",centered:!0,visible:n,maskClosable:!1,destroyOnClose:!0,footer:!1,onCancel:function(){return i(!1)},children:l})}function z(){var e=Object(s.useState)(!1),t=Object(d.a)(e,2),n=t[0],i=t[1];return Object(c.jsx)(l.a,{style:{background:"url(https://i.loli.net/2020/01/25/KEScJXCBfAzaIjW.png) no-repeat",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",height:"95vh"},children:Object(c.jsx)(o.a,{lg:{span:14,offset:5},xs:{span:22,offset:1},className:"display-flex align-center justify-around",children:Object(c.jsxs)("div",{className:"text-center",children:[Object(c.jsx)(I,{}),Object(c.jsx)("span",{style:{fontSize:30,fontWeight:700,color:"#ffffff"},children:"\u6b22\u8fce\u4f7f\u7528 Office"}),Object(c.jsx)("br",{}),Object(c.jsx)("span",{style:{fontSize:20,fontWeight:400,color:"#ffffff"},children:"\u4f60\u53ef\u5728\u8fd9\u91cc\u521b\u4f5c\u3001\u6c9f\u901a\u3001\u534f\u4f5c\u5e76\u5b8c\u6210\u91cd\u8981\u5de5\u4f5c\u3002"}),Object(c.jsx)("br",{}),Object(c.jsx)("br",{}),Object(c.jsxs)(j.b,{children:[Object(c.jsx)(b.a,{style:{width:110},type:"primary",danger:!0,size:"large",onClick:function(){return i((function(e){return!e}))},children:"\u83b7\u53d6 Office"}),Object(c.jsx)(h.a,{title:"\u83b7\u53d6 Office",centered:!0,visible:n,width:1e3,maskClosable:!1,destroyOnClose:!0,footer:!1,onCancel:function(){return i(!1)},children:Object(c.jsx)(S,{})}),Object(c.jsx)(b.a,{style:{width:110},size:"large",onClick:function(){return window.open("https://office.com/login")},children:"\u767b\u5f55"})]})]})})})}function N(){return Object(c.jsxs)(a.a,{children:[Object(c.jsx)(a.a.Header,{className:"background-white",style:{padding:0},children:Object(c.jsx)(u,{})}),Object(c.jsx)(a.a.Content,{children:Object(c.jsx)(z,{})})]})}r.a.render(Object(c.jsx)(N,{}),document.getElementById("root"))}},[[284,1,2]]]);